-- Создание базы данных
CREATE DATABASE IF NOT EXISTS Друзья_людей_DB;
USE Друзья_людей_DB;

-- Создание таблицы ДрузьяЛюди
CREATE TABLE IF NOT EXISTS Друзья_людей (
    id INT AUTO_INCREMENT PRIMARY KEY,
    тип VARCHAR(50)
);

-- Создание таблицы ДомашниеЖивотные
CREATE TABLE IF NOT EXISTS Домашние_Животные (
    id INT AUTO_INCREMENT PRIMARY KEY,
    id_друзья_людей INT,
	тип VARCHAR(50),
    FOREIGN KEY (id_друзья_людей) REFERENCES Друзья_людей(id)
);

-- Создание таблицы ВьючныеЖивотные
CREATE TABLE IF NOT EXISTS Вьючные_Животные (
    id INT AUTO_INCREMENT PRIMARY KEY,
    id_друзья_людей INT,
    тип VARCHAR(50),
    FOREIGN KEY (id_друзья_людей) REFERENCES Друзья_людей(id)
);

-- Создание таблицы Ослы
CREATE TABLE IF NOT EXISTS Ослы (
    id INT AUTO_INCREMENT PRIMARY KEY,
    id_Вьючные_Животные INT,
    название_животного VARCHAR(100),
    дата_рождения DATE,
    команды VARCHAR(255),
    FOREIGN KEY (id_Вьючные_Животные) REFERENCES Вьючные_Животные(id)
);

-- Создание таблицы Лошади
CREATE TABLE IF NOT EXISTS Лошади (
    id INT AUTO_INCREMENT PRIMARY KEY,
    id_Вьючные_Животные INT,
    название_животного VARCHAR(100),
    дата_рождения DATE,
    команды VARCHAR(255),
    FOREIGN KEY (id_Вьючные_Животные) REFERENCES Вьючные_Животные(id)
);

-- Создание таблицы Верблюды
CREATE TABLE IF NOT EXISTS Верблюды (
    id INT AUTO_INCREMENT PRIMARY KEY,
	id_Вьючные_Животные INT,
    название_животного VARCHAR(100),
    дата_рождения DATE,
    команды VARCHAR(255),
    FOREIGN KEY (id_Вьючные_Животные) REFERENCES Вьючные_Животные(id)
);

-- Создание таблицы Кошки
CREATE TABLE IF NOT EXISTS Кошки (
    id INT AUTO_INCREMENT PRIMARY KEY,
    id_Домашние_Животные INT,
    название_животного VARCHAR(100),
    дата_рождения DATE,
    команды VARCHAR(255),
    FOREIGN KEY (id_Домашние_Животные) REFERENCES Домашние_Животные(id)
);

-- Создание таблицы Собаки
CREATE TABLE IF NOT EXISTS Собаки (
    id INT AUTO_INCREMENT PRIMARY KEY,
    id_Домашние_Животные INT,
    название_животного VARCHAR(100),
    дата_рождения DATE,
    команды VARCHAR(255),
    FOREIGN KEY (id_Домашние_Животные) REFERENCES Домашние_Животные(id)
);

-- Создание таблицы Хомяки
CREATE TABLE IF NOT EXISTS Хомяки (
    id INT AUTO_INCREMENT PRIMARY KEY,
    id_Домашние_Животные INT,
    название_животного VARCHAR(100),
    дата_рождения DATE,
    команды VARCHAR(255),
    FOREIGN KEY (id_Домашние_Животные) REFERENCES Домашние_Животные(id)
);

-- заполняем таблицы
INSERT INTO Друзья_людей (тип) VALUES
('ДомашниеЖивотные'),
('ВьючныеЖивотные');

INSERT INTO Домашние_Животные (id_друзья_людей, тип) VALUES
(1, 'Кошки'),
(1, 'Собаки'),
(1, 'Хомяки');

INSERT INTO Вьючные_Животные (id_друзья_людей, тип) VALUES
(2, 'Ослы'),
(2, 'Лошади'),
(2, 'Верблюды');


-- Заполняем таблицу Лошади
INSERT INTO Лошади (id_Вьючные_Животные, название_животного, дата_рождения, команды) VALUES
(2, 'Артур', '2018-03-15', 'Подковать, Пройти ворота, Верхом по горам'),
(2, 'Бриз', '2019-07-22', 'Скачать на дистанцию, Прыжок через препятствие'),
(2, 'Виктория', '2017-11-10', 'Скачать на площадку, Подготовка к соревнованиям'),
(2, 'Гектор', '2020-05-05', 'Участие в конкурсах выносливости, Поводья и управление'),
(2, 'Дарина', '2016-09-28', 'Обучение для детей, Участие в парадах');

-- Заполняем таблицу Ослы
INSERT INTO Ослы (id_Вьючные_Животные, название_животного, дата_рождения, команды) VALUES
(1, 'Оскар', '2017-12-01', 'Грузовые перевозки, Участие в экскурсиях'),
(1, 'Пегас', '2019-05-18', 'Тягловые работы, Транспортировка грузов'),
(1, 'Рокки', '2018-08-10', 'Участие в фестивалях, Посещение школ и детских садов'),
(1, 'Снежок', '2020-02-25', 'Участие в спектаклях, Детская терапия'),
(1, 'Тройка', '2016-11-30', 'Туристические поездки, Помощь на фермах');

-- Заполняем таблицу Верблюды
INSERT INTO Верблюды (id_Вьючные_Животные, название_животного, дата_рождения, команды) VALUES
(3, 'Жасмин', '2018-04-12', 'Участие в киносъемках, Туристические прогулки'),
(3, 'Зефир', '2017-09-05', 'Участие в фотосессиях, Поездки по пустыням'),
(3, 'Индиго', '2019-06-20', 'Участие в рекламе, Тематические мероприятия'),
(3, 'Карамель', '2020-01-15', 'Праздничные шествия, Экскурсии по зоопаркам'),
(3, 'Лимонад', '2016-10-28', 'Участие в культурных мероприятиях, Конные путешествия');

-- Заполняем таблицу Кошки
INSERT INTO Кошки (id_Домашние_Животные, название_животного, дата_рождения, команды) VALUES
(1, 'Мурзик', '2019-02-14', 'Прыжки на высоту, Ловля игрушек'),
(1, 'Васька', '2018-08-03', 'Участие в выставках, Обучение щенков'),
(1, 'Барсик', '2017-11-25', 'Поиск и спасение, Дружба с детьми'),
(1, 'Симба', '2020-04-30', 'Кошачьи трюки, Участие в киносъемках'),
(1, 'Рыжик', '2016-12-12', 'Полезные навыки для хозяев, Участие в рекламе');

-- Заполняем таблицу Собаки
INSERT INTO Собаки (id_Домашние_Животные, название_животного, дата_рождения, команды) VALUES
(2, 'Бобик', '2017-09-20', 'Поиск и спасение, Охрана дома'),
(2, 'Шарик', '2016-11-10', 'Посещение больных, Терапия для пожилых людей'),
(2, 'Рекс', '2018-03-05', 'Участие в соревнованиях, Поиск пропавших предметов'),
(2, 'Тайсон', '2019-05-12', 'Поведение на поводке, Участие в выставках'),
(2, 'Джесси', '2020-02-08', 'Дрессировка для детей, Поиск наркотиков');
-- Заполняем таблицу Хомяки
INSERT INTO Хомяки (id_Домашние_Животные, название_животного, дата_рождения, команды) VALUES
(3, 'Шурик', '2020-01-10', 'Исследование тоннелей, Подготовка к соревнованиям'),
(3, 'Карамелька', '2018-07-15', 'Прыжки через препятствия, Участие в выставках'),
(3, 'Боня', '2017-12-08', 'Участие в рекламе, Поиск вкусной еды'),
(3, 'Рыжик', '2016-06-01', 'Конструирование тоннелей, Участие в выставках');

-- Удаляем верблюдов из таблицы Верблюды
DELETE FROM Верблюды;

-- Объединяем таблицы Лошади и Ослы в одну
CREATE TABLE Лошади_и_Ослы AS
SELECT * FROM Лошади
UNION ALL
SELECT * FROM Ослы;


-- Создание новой таблицы "молодые животные"
CREATE TABLE Молодые_животные AS
SELECT *
FROM (
    SELECT *,
           TIMESTAMPDIFF(MONTH, дата_рождения, CURDATE()) AS возраст_в_месяцах
    FROM (
        SELECT * FROM Домашние_Животные
        UNION ALL
        SELECT * FROM Вьючные_Животные
    ) AS Все_животные
) AS Молодые
WHERE возраст_в_месяцах BETWEEN 12 AND 36;